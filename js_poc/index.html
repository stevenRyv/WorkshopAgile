<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Monster Fight</title>

    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"> </script>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

    <!-- Custom Fonts -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">

	<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

    <style>
        .progress {
            position: relative;
        }

        .progress span {
            position: absolute;
            display: block;
            width: 100%;
        }
    </style>


</head>

<body>

	<audio autoplay loop>
      <source src="../Music/music.mp3">
	</audio>

    <div id="wrapper">

        <!-- Navigation -->
        <nav class="navbar navbar-default navbar-static-top" role="navigation" style="margin-bottom: 0">
            <div class="navbar-header">
                <a class="navbar-brand" href="index.html">Monster Fight</a>
            </div>
            <!-- /.navbar-header -->

            <div class="navbar-default sidebar" role="navigation">
                <div class="sidebar-nav navbar-collapse">
                    <ul class="nav" id="side-menu">
                        
                        <li>
                            <a href="index.html"><i class="fa fa-dashboard fa-fw"></i>Accueil</a>
                        </li>
                    </ul>
                </div>
                <!-- /.sidebar-collapse -->
            </div>
            <!-- /.navbar-static-side -->
        </nav>
    </div>
    <!-- /#wrapper -->

    <div class="container" style="text-align: center; outline-style: solid;">
        <h1>Combat</h1>

        <h2 id="victory" style="visibility: hidden; color: green;">Vous avez battu le monstre !</h2>

        <div >
            <div class="progress">
                <div id="health-bar" class="progress-bar" role="progressbar" aria-valuenow="10" aria-valuemin="0" aria-valuemax="10" style="width: 100%;"> 
                    <span id="health-text">10 / 10</span> 
                </div>
            </div>

            <img  id="monster" src="../Monstres/monster4.png" style="width: 20%;">

            
            <div class="progress" style="width:25%">
                <div id="xp-bar" class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="5" style="width: 0%;"> 
                    <span id="xp-text"></span> 
                </div>
            </div>
        </div>

    </div>



    <script type="text/javascript">
        var heroStrength = 2;
        var heroXP = 0;
        var heroXPNextLevel = 5;
        var monsterXP = 5;
        var maxHealth = 10; 
        var health = 10;


        var healthBarElem = document.getElementById("health-bar"); 
        var xpBarElem = document.getElementById("xp-bar"); 

        $('#monster').on('click', function() {
            console.log("1- health : " + health + " max health : " + maxHealth);

            Init();

            HitMonster();


            if(health <= 0) {
                GetXP();
                DeadMonster();
            }

            HitMonster(heroStrength);
        });

        function Init()
        {
            document.getElementById("health-text").innerHTML = health + " / " + maxHealth;
            healthBarElem.style.width = Math.floor(health / 100 * maxHealth) + '%';
        }

        function HitMonster() 
        {  
            var width = healthBarElem.style.width.slice(0, -1);  
            health = health - heroStrength; 
            console.log("2- health : " + health + " max health : " + maxHealth); 
            var nWidth = Math.floor(health * 100 / maxHealth); 

            document.getElementById("health-text").innerHTML = health + " / " + maxHealth;
            healthBarElem.style.width = Math.floor(health * 100 / 100 * maxHealth) + '%';
        } 

        function DeadMonster()
        {
            console.log("MONSTRE BATTU");
            $('#monster').prop("src", "../Monstres/coffin.png");
            $("#victory").css("visibility", "visible");
        }

        function GetXP()
        {
            heroXP =+ monsterXP;

            document.getElementById("xp-text").innerHTML = heroXP + " / " + heroXPNextLevel;
            xpBarElem.style.width = Math.floor((heroXP *100)/ heroXPNextLevel) + '%';

        }
        </script>


</body>

</html>