<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Monster Fight</title>

    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"> </script>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

    <!-- Custom Fonts -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">

	<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

    <style>
        .progress {
            position: relative;
        }

        .progress span {
            position: absolute;
            display: block;
            width: 100%;
        }
    </style>


</head>

<body>

    <div id="wrapper">

        <!-- Navigation -->
        <nav class="navbar navbar-default navbar-static-top" role="navigation" style="margin-bottom: 0">
            <div class="navbar-header">
                <a class="navbar-brand" href="index.html">Monster Fight</a>
            </div>
            <!-- /.navbar-header -->

            <div class="navbar-default sidebar" role="navigation">
                <div class="sidebar-nav navbar-collapse">
                    <ul class="nav" id="side-menu">
                        
                        <li>
                            <a href="index.html"><i class="fa fa-dashboard fa-fw"></i>Accueil</a>
                        </li>
                    </ul>
                </div>
                <!-- /.sidebar-collapse -->
            </div>
            <!-- /.navbar-static-side -->
        </nav>
    </div>
    <!-- /#wrapper -->

    <div class="container" style="text-align: center; outline-style: solid;">
        <h1>Combat</h1>

        <div id="monster">
            <div class="progress">
                <div class="progress-bar" role="progressbar" aria-valuenow="10" aria-valuemin="0" aria-valuemax="10" style="width: 100%;">
                    <span>10 / 10</span>
                </div>
            </div>

            <img src="/WorkshopAgile/Monstres/monster4.png" style="width: 20%;">
        </div>

    </div>



    <script type="text/javascript">
        setInterval( function() { get_humeur(1); }, 1000 );
        setInterval( function() { get_humeur(2); }, 1000 );

        function get_humeur(machine) {
            
            var url = "phpmachine"+machine+".php";
            var donnees = $('#donnees');

            $.ajax({
              type: "GET",
              url: url,
              data: donnees.serialize(), // serializes the form's elements.
              contentType:"application/json; charset=utf-8",
              dataType: "json",

              beforeSend: function(){
                
              },
              success: function(data)
              {
                 console.log("data : " + data);
                 var humeur = data;
                 var smiley = "";
                 if(humeur >= 5) {
                    smiley = "<i class='far fa-smile' style='color: green'></i>";
                    $('#td_humeur_'+machine).attr( "class", "success");
                 } else if (humeur >= 3 && humeur < 5) {
                    smiley = "<i class='far fa-meh' style='color: orange'></i>";
                    $('#td_humeur_'+machine).attr( "class", "");
                 } else if (humeur >= 1 && humeur < 3) {
                    smiley = "<i class='far fa-frown' style='color: red'></i>";
                    $('#td_humeur_'+machine).attr( "class", "danger");
                    $('#smiley_'+machine).effect( "shake", { direction: "left", times: 2, distance: 5});
                    
                    var start = new Date;
                    setInterval(function() {
                        $('#timer_'+machine).text((new Date - start) / 1000 + " Seconds");
                    }, 1000);
                 } else {
                    smiley = "";
                 }

                 if(humeur == 0) {
                    humeur = "";
                    $('#td_humeur_'+machine).attr( "class", "");
                    smiley = "<i class='far fa-times-circle'></i>";
                 }

                $("#humeur_"+machine).text(humeur);
                $("#smiley_"+machine).html(smiley);
              },
              error : function(xhr, errorText){
                 console.log(url);
                 console.log('Error '+ xhr.responseText);
              },
              complete : function(data) {
                

              }
            });
        }
        </script>


</body>

</html>
